"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const db_1 = require("./db");
const models_1 = require("./models");
const const_1 = require("./const");
const utils_1 = require("./utils");
require('dotenv').config('./.env');
const task = utils_1.checkArgs();
if (!task) {
    process.argv.forEach((val, index) => {
        console.log(`${index}: ${val}`);
    });
    utils_1.showHelp();
    process.exit(0);
}
let tmpEmplName = {};
let tmpPatronymic = '';
const tmpPhone = utils_1.randomPhone();
let tmpAddr = {};
let tmpBuilding = null;
let tmpApartment = 0;
let tmpCity;
let id = -1;
const db = new db_1.ShopDB(process.env.DB_PATH);
if (task === const_1.Task.cashierCreate) {
    tmpEmplName = {
        lastName: process.argv[3],
        firstName: process.argv[4],
        patronymic: '',
    };
    tmpCity = models_1.City[process.argv[5]];
    tmpCity = (tmpCity) || models_1.City.Львов;
    tmpAddr = {
        city: tmpCity,
        street: process.argv[6],
        building: process.argv[7],
        apartment: process.argv[8],
    };
    const newCashier = {
        id: null,
        personnelNumber: utils_1.randomPN(),
        employeeName: tmpEmplName,
        sex: models_1.Sex.female,
        phone: tmpPhone,
        addr: tmpAddr,
        birthday: null,
        shopID: 17,
        startWork: new Date(2021, 2, 18),
        endWork: null,
        lastNet: models_1.Net.Comfy,
    };
    const newCashierId = db.addCashier(newCashier);
    newCashierId.then((value) => {
        newCashier.id = value;
        const tmpCashier = db.getCashierById(newCashier.id);
        tmpCashier.then((values) => {
            const cashier = values;
            console.log(`Информация о новом кассире с id ${newCashier.id}:\n`, cashier);
        });
    });
}
if (task === const_1.Task.cashierUpdate) {
    id = process.argv[3];
    tmpPatronymic = process.argv[4];
    tmpBuilding = process.argv[5];
    tmpApartment = process.argv[6];
    const tmpCashier = db.getCashierById(id);
    tmpCashier.then((values) => {
        const cashier = values;
        console.log(`Исходные данные кассира с id ${id}:\n`, cashier);
        cashier.addr.city = cashier.addr.city;
        cashier.employeeName.patronymic = tmpPatronymic;
        cashier.addr.building = tmpBuilding;
        cashier.addr.apartment = tmpApartment;
        db.updateCashier(cashier);
        console.log(`Внесенные изменения о кассире с id ${id}:\n`, cashier);
    });
}
if (task === const_1.Task.getCashierById) {
    id = process.argv[3];
    const targetCashier = db.getCashierById(id);
    targetCashier.then((val) => {
        console.log(`Информация о кассире с id ${id}:\n`, val);
    });
}
if (task === const_1.Task.cashierDelete) {
    id = process.argv[3];
    db.completDeleteCashier(id);
}
if (task === const_1.Task.getAllCashiers) {
    db.getAllCashiers();
}
if (task === const_1.Task.useFilter1) {
    const fltr1 = {
        firstName: 'Анна',
        lastNet: models_1.Net['Metro Cash&Carry'],
    };
    db.getAllFiltredCashiers(fltr1);
}
if (task === const_1.Task.useFilter2) {
    const fltr2 = {
        operator: '096',
        city: models_1.City.Мариуполь,
    };
    db.getAllFiltredCashiers(fltr2);
}
if (task === const_1.Task.getTargetCashiers1) {
    db.getTargetCashiers1();
}
if (task === const_1.Task.getTargetCashiers2) {
    db.getTargetCashiers2();
}
if (!task) {
    db.close();
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXBwLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc3JjL2FwcC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUNBLDZCQUE4QjtBQUM5QixxQ0FFa0I7QUFDbEIsbUNBQStCO0FBQy9CLG1DQUFxRTtBQUVyRSxPQUFPLENBQUMsUUFBUSxDQUFDLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDO0FBR25DLE1BQU0sSUFBSSxHQUFvQixpQkFBUyxFQUFFLENBQUM7QUFDMUMsSUFBSSxDQUFDLElBQUksRUFBRTtJQUNULE9BQU8sQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsR0FBRyxFQUFFLEtBQUssRUFBRSxFQUFFO1FBQ2xDLE9BQU8sQ0FBQyxHQUFHLENBQUMsR0FBRyxLQUFLLEtBQUssR0FBRyxFQUFFLENBQUMsQ0FBQztJQUNsQyxDQUFDLENBQUMsQ0FBQztJQUNILGdCQUFRLEVBQUUsQ0FBQztJQUNYLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7Q0FDakI7QUFHRCxJQUFJLFdBQVcsR0FBYyxFQUFFLENBQUM7QUFDaEMsSUFBSSxhQUFhLEdBQVUsRUFBRSxDQUFDO0FBQzlCLE1BQU0sUUFBUSxHQUFVLG1CQUFXLEVBQUUsQ0FBQztBQUN0QyxJQUFJLE9BQU8sR0FBb0IsRUFBRSxDQUFDO0FBQ2xDLElBQUksV0FBVyxHQUFPLElBQUksQ0FBQztBQUMzQixJQUFJLFlBQVksR0FBVSxDQUFDLENBQUM7QUFDNUIsSUFBSSxPQUFnQixDQUFDO0FBQ3JCLElBQUksRUFBRSxHQUFVLENBQUMsQ0FBQyxDQUFDO0FBR25CLE1BQU0sRUFBRSxHQUFHLElBQUksV0FBTSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsT0FBaUIsQ0FBQyxDQUFDO0FBR3JELElBQUksSUFBSSxLQUFLLFlBQUksQ0FBQyxhQUFhLEVBQUU7SUFDL0IsV0FBVyxHQUFHO1FBQ1osUUFBUSxFQUFFLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FB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RUFBRSxDQUFDLHFCQUFxQixDQUFDLEtBQUssQ0FBQyxDQUFDO0NBQ2pDO0FBR0QsSUFBSSxJQUFJLEtBQUssWUFBSSxDQUFDLGtCQUFrQixFQUFFO0lBQ3BDLEVBQUUsQ0FBQyxrQkFBa0IsRUFBRSxDQUFDO0NBQ3pCO0FBR0QsSUFBSSxJQUFJLEtBQUssWUFBSSxDQUFDLGtCQUFrQixFQUFFO0lBQ3BDLEVBQUUsQ0FBQyxrQkFBa0IsRUFBRSxDQUFDO0NBQ3pCO0FBR0QsSUFBSSxDQUFDLElBQUksRUFBRTtJQUNULEVBQUUsQ0FBQyxLQUFLLEVBQUUsQ0FBQztDQUNaIiwic291cmNlc0NvbnRlbnQiOlsiLy8gYXBwIG1haW4gcG9pbnQ7XG5pbXBvcnQgeyBTaG9wREIgfSBmcm9tICcuL2RiJztcbmltcG9ydCB7XG4gIElDYXNoaWVyLCBTZXgsIENpdHksIE5ldCwgU3FsRmlsdGVyLCBOYW1lLCBBZGRyZXNzLFxufSBmcm9tICcuL21vZGVscyc7XG5pbXBvcnQgeyBUYXNrIH0gZnJvbSAnLi9jb25zdCc7XG5pbXBvcnQgeyBjaGVja0FyZ3MsIHJhbmRvbVBob25lLCByYW5kb21QTiwgc2hvd0hlbHAgfSBmcm9tICcuL3V0aWxzJztcblxucmVxdWlyZSgnZG90ZW52JykuY29uZmlnKCcuLy5lbnYnKTtcblxuLy8gY2hlY2sgY29tbWFuZCBsaW5lIGFyZ3VtZW50cy4gSWYgZXJyb3IgLSBzaG93IGhlbHAgYW5kIGV4aXRcbmNvbnN0IHRhc2s6VGFzayB8IHVuZGVmaW5lZCA9IGNoZWNrQXJncygpO1xuaWYgKCF0YXNrKSB7XG4gIHByb2Nlc3MuYXJndi5mb3JFYWNoKCh2YWwsIGluZGV4KSA9PiB7XG4gICAgY29uc29sZS5sb2coYCR7aW5kZXh9OiAke3ZhbH1gKTtcbiAgfSk7XG4gIHNob3dIZWxwKCk7XG4gIHByb2Nlc3MuZXhpdCgwKTtcbn1cblxuLy8gdGFzayBzZWVtcyBvaywgY29udGludWUgcHJvZ3JhbW1cbmxldCB0bXBFbXBsTmFtZTpOYW1lID0gPE5hbWU+e307XG5sZXQgdG1wUGF0cm9ueW1pYzpzdHJpbmcgPSAnJztcbmNvbnN0IHRtcFBob25lOnN0cmluZyA9IHJhbmRvbVBob25lKCk7XG5sZXQgdG1wQWRkcjpBZGRyZXNzID0gPEFkZHJlc3M+e307XG5sZXQgdG1wQnVpbGRpbmc6YW55ID0gbnVsbDtcbmxldCB0bXBBcGFydG1lbnQ6bnVtYmVyID0gMDtcbmxldCB0bXBDaXR5OkNpdHl8YW55O1xubGV0IGlkOm51bWJlciA9IC0xO1xuXG4vLyBjb25uZWN0aW5nIHRvIHRoZSBzaG9wIERCIChsb2dpbiBhbmQgcGFzc3dvcmQgbm90IHJlcXVpcmUpXG5jb25zdCBkYiA9IG5ldyBTaG9wREIocHJvY2Vzcy5lbnYuREJfUEFUSCBhcyBzdHJpbmcpO1xuXG4vLyBjcmVhdGluZyBhIG5ldyBDYXNoZWlyLCBnZXQgaW5mb3JtYXRpb24gYWJvdXQgaXQgYW5kIHVwZGF0ZSBzb21lIGZpZWxkc1xuaWYgKHRhc2sgPT09IFRhc2suY2FzaGllckNyZWF0ZSkge1xuICB0bXBFbXBsTmFtZSA9IHtcbiAgICBsYXN0TmFtZTogcHJvY2Vzcy5hcmd2WzNdLFxuICAgIGZpcnN0TmFtZTogcHJvY2Vzcy5hcmd2WzRdLFxuICAgIHBhdHJvbnltaWM6ICcnLFxuICB9O1xuXG4gIHRtcENpdHkgPSBDaXR5W3Byb2Nlc3MuYXJndls1XSBhcyBhbnldO1xuICB0bXBDaXR5ID0gKHRtcENpdHkpIHx8IENpdHku0JvRjNCy0L7QsjtcbiAgLy8gY29uc29sZS5sb2codG1wQ2l0eSk7XG5cbiAgdG1wQWRkciA9IHtcbiAgICBjaXR5OiB0bXBDaXR5LFxuICAgIHN0cmVldDogcHJvY2Vzcy5hcmd2WzZdLFxuICAgIGJ1aWxkaW5nOiBwcm9jZXNzLmFyZ3ZbN10gYXMgdW5rbm93biBhcyBudW1iZXIsXG4gICAgYXBhcnRtZW50OiBwcm9jZXNzLmFyZ3ZbOF0gYXMgdW5rbm93biBhcyBudW1iZXIsXG4gIH07XG5cbiAgY29uc3QgbmV3Q2FzaGllcjpJQ2FzaGllciA9IHtcbiAgICBpZDogbnVsbCxcbiAgICBwZXJzb25uZWxOdW1iZXI6IHJhbmRvbVBOKCksXG4gICAgZW1wbG95ZWVOYW1lOiB0bXBFbXBsTmFtZSxcbiAgICBzZXg6IFNleC5mZW1hbGUsXG4gICAgcGhvbmU6IHRtcFBob25lLFxuICAgIGFkZHI6IHRtcEFkZHIsXG4gICAgYmlydGhkYXk6IG51bGwsXG4gICAgc2hvcElEOiAxNyxcbiAgICBzdGFydFdvcms6IG5ldyBEYXRlKDIwMjEsIDIsIDE4KSwgLy8gTW9udGggaW4gMC0xMVxuICAgIGVuZFdvcms6IG51bGwsXG4gICAgbGFzdE5ldDogTmV0LkNvbWZ5LFxuICB9O1xuXG4gIC8vIGFkZGluZyBjcmVhdGVkIENhc2hpZXIgdG8gdGhlIERCXG4gIGNvbnN0IG5ld0Nhc2hpZXJJZDpQcm9taXNlPG51bWJlcj4gPSBkYi5hZGRDYXNoaWVyKG5ld0Nhc2hpZXIpO1xuICBuZXdDYXNoaWVySWQudGhlbigodmFsdWUpID0+IHtcbiAgICBuZXdDYXNoaWVyLmlkID0gdmFsdWU7XG4gICAgLy8gY29uc29sZS5sb2cobmV3Q2FzaGllci5pZCk7XG5cbiAgICAvLyBnZXR0aW5nIGluZm9ybWF0aW9uIGFib3V0IGNhc2hpZXIgd2l0aCBuZXdDYXNoaWVyLmlkXG4gICAgY29uc3QgdG1wQ2FzaGllcjpQcm9taXNlPElDYXNoaWVyPiA9IGRiLmdldENhc2hpZXJCeUlkKG5ld0Nhc2hpZXIuaWQpO1xuICAgIHRtcENhc2hpZXIudGhlbigodmFsdWVzKSA9PiB7XG4gICAgICBjb25zdCBjYXNoaWVyOklDYXNoaWVyID0gdmFsdWVzO1xuICAgICAgY29uc29sZS5sb2coYNCY0L3RhNC+0YDQvNCw0YbQuNGPINC+INC90L7QstC+0Lwg0LrQsNGB0YHQuNGA0LUg0YEgaWQgJHtuZXdDYXNoaWVyLmlkfTpcXG5gLCBjYXNoaWVyKTtcbiAgICB9KTtcbiAgfSk7XG59XG5cbi8vIGdldHRpbmcgaW5mb3JtYXRpb24gYWJvdXQgY2FzaGllciB3aXRoIG5ld0Nhc2hpZXIuaWQgYW5kIHVwZGF0aW5nIGl0XG5pZiAodGFzayA9PT0gVGFzay5jYXNoaWVyVXBkYXRlKSB7XG4gIGlkID0gcHJvY2Vzcy5hcmd2WzNdIGFzIHVua25vd24gYXMgbnVtYmVyO1xuICB0bXBQYXRyb255bWljID0gcHJvY2Vzcy5hcmd2WzRdO1xuICB0bXBCdWlsZGluZyA9IHByb2Nlc3MuYXJndls1XSBhcyB1bmtub3duIGFzIG51bWJlcjtcbiAgdG1wQXBhcnRtZW50ID0gcHJvY2Vzcy5hcmd2WzZdIGFzIHVua25vd24gYXMgbnVtYmVyO1xuXG4gIGNvbnN0IHRtcENhc2hpZXI6UHJvbWlzZTxJQ2FzaGllcj4gPSBkYi5nZXRDYXNoaWVyQnlJZChpZCk7XG4gIHRtcENhc2hpZXIudGhlbigodmFsdWVzKSA9PiB7XG4gICAgY29uc3QgY2FzaGllcjpJQ2FzaGllciA9IHZhbHVlcztcbiAgICBjb25zb2xlLmxvZyhg0JjRgdGF0L7QtNC90YvQtSDQtNCw0L3QvdGL0LUg0LrQsNGB0YHQuNGA0LAg0YEgaWQgJHtpZH06XFxuYCwgY2FzaGllcik7XG5cbiAgICAvLyB1cGRhdGluZyBpbmZvcm1hdGlvbiBhYm91dCBjYXNoaWVyXG4gICAgY2FzaGllci5hZGRyLmNpdHkgPSBjYXNoaWVyLmFkZHIuY2l0eSBhcyB1bmtub3duIGFzIG51bWJlcjtcbiAgICBjYXNoaWVyLmVtcGxveWVlTmFtZS5wYXRyb255bWljID0gdG1wUGF0cm9ueW1pYztcbiAgICBjYXNoaWVyLmFkZHIuYnVpbGRpbmcgPSB0bXBCdWlsZGluZztcbiAgICBjYXNoaWVyLmFkZHIuYXBhcnRtZW50ID0gdG1wQXBhcnRtZW50O1xuICAgIGRiLnVwZGF0ZUNhc2hpZXIoY2FzaGllcik7XG4gICAgY29uc29sZS5sb2coYNCS0L3QtdGB0LXQvdC90YvQtSDQuNC30LzQtdC90LXQvdC40Y8g0L4g0LrQsNGB0YHQuNGA0LUg0YEgaWQgJHtpZH06XFxuYCwgY2FzaGllcik7XG4gIH0pO1xufVxuXG4vLyBnZXR0aW5nIGluZm9ybWF0aW9uIGFib3V0IGNhc2hpZXIgYnkgaWRcbmlmICh0YXNrID09PSBUYXNrLmdldENhc2hpZXJCeUlkKSB7XG4gIGlkID0gcHJvY2Vzcy5hcmd2WzNdIGFzIHVua25vd24gYXMgbnVtYmVyO1xuICBjb25zdCB0YXJnZXRDYXNoaWVyOlByb21pc2U8SUNhc2hpZXI+ID0gZGIuZ2V0Q2FzaGllckJ5SWQoaWQpO1xuICB0YXJnZXRDYXNoaWVyLnRoZW4oKHZhbCkgPT4ge1xuICAgIGNvbnNvbGUubG9nKGDQmNC90YTQvtGA0LzQsNGG0LjRjyDQviDQutCw0YHRgdC40YDQtSDRgSBpZCAke2lkfTpcXG5gLCB2YWwpO1xuICB9KTtcbn1cblxuLy8gZGVsZXRpbmcgaW5mb3JtYXRpb24gYWJvdXQgY2FzaGllciB3aXRoIHNvbWUgaWRcbmlmICh0YXNrID09PSBUYXNrLmNhc2hpZXJEZWxldGUpIHtcbiAgaWQgPSBwcm9jZXNzLmFyZ3ZbM10gYXMgdW5rbm93biBhcyBudW1iZXI7XG4gIC8vIGRiLmRlbENhc2hpZXIoMjApO1xuICBkYi5jb21wbGV0RGVsZXRlQ2FzaGllcihpZCk7XG59XG4vLyBnZXR0aW5nIGluZm8gYWJvdXQgYWxsIGNhc2hpZXJzXG5pZiAodGFzayA9PT0gVGFzay5nZXRBbGxDYXNoaWVycykge1xuICBkYi5nZXRBbGxDYXNoaWVycygpO1xufVxuXG4vLyBnZXR0aW5nIGluZm8gYWJvdXQgYWxsIGNhc2hpZXJzIGFjY29yZGluZyBzb21lIGZpbHRlcnNcbi8vIGdldCBhbGwgY2FzaGllcnMgd2l0aCBmaXJzdCBuYW1lIEFubmEgd2hpY2ggd29ya2VkIGluIE1ldHJvIENhc2gmQ2FycnlcbmlmICh0YXNrID09PSBUYXNrLnVzZUZpbHRlcjEpIHtcbiAgY29uc3QgZmx0cjE6U3FsRmlsdGVyID0ge1xuICAgIGZpcnN0TmFtZTogJ9CQ0L3QvdCwJyxcbiAgICBsYXN0TmV0OiBOZXRbJ01ldHJvIENhc2gmQ2FycnknXSxcbiAgfTtcbiAgZGIuZ2V0QWxsRmlsdHJlZENhc2hpZXJzKGZsdHIxKTtcbn1cblxuLy8gZ2V0IGFsbCBjYXNoaWVycyBmcm9tIE1hcml1cG9sIGFuZCBwaG9uZSBudW1iZXIgd2l0aCBjb2RlIG9wZXJhdG9yIDA5NlxuaWYgKHRhc2sgPT09IFRhc2sudXNlRmlsdGVyMikge1xuICBjb25zdCBmbHRyMiA9IHtcbiAgICBvcGVyYXRvcjogJzA5NicsXG4gICAgY2l0eTogQ2l0eS7QnNCw0YDQuNGD0L/QvtC70YwsXG4gIH07XG4gIGRiLmdldEFsbEZpbHRyZWRDYXNoaWVycyhmbHRyMik7XG59XG5cbi8vIGdldHRpbmcgaW5mb3JtYXRpb24gYWJvdXQgY2FzaGllciB3aXRoIGEgc3BlY2lhbCBmaWx0ZXJfMVxuaWYgKHRhc2sgPT09IFRhc2suZ2V0VGFyZ2V0Q2FzaGllcnMxKSB7XG4gIGRiLmdldFRhcmdldENhc2hpZXJzMSgpO1xufVxuXG4vLyBnZXR0aW5nIGluZm9ybWF0aW9uIGFib3V0IGNhc2hpZXIgd2l0aCBhIHNwZWNpYWwgZmlsdGVyXzJcbmlmICh0YXNrID09PSBUYXNrLmdldFRhcmdldENhc2hpZXJzMikge1xuICBkYi5nZXRUYXJnZXRDYXNoaWVyczIoKTtcbn1cblxuLy8gY2xvc2UgREIgYW5kIGNvbm5lY3Rpb25cbmlmICghdGFzaykge1xuICBkYi5jbG9zZSgpO1xufVxuIl19